*** Settings ***
Library        rammbock.Rammbock
Default Tags   regression
Test Setup     Create Two TCP Servers And Clients
Test Teardown  Delete Two Servers And Clients And Verify Deletion

*** Variables ***
${SERVER_NAME1}  testiserveri1
${SERVER_NAME2}  testiserveri2
${DEFAULT_PORT1}  77321 
${DEFAULT_PORT2}  32132

${CLIENT_NAME1}  testiclient1
${CLIENT_NAME2}  testiclient2


*** Test Cases ***
Create and delete two intances of Servers
    Check Server Existence  ${SERVER_NAME1}  ${True}
    Check Server Existence  ${SERVER_NAME2}  ${True}

Create and delete two instances of Clients
    Check Client Existence  ${CLIENT_NAME1}  ${True}
    Check Client Existence  ${CLIENT_NAME2}  ${True}

Send data between multiple Client and Server instances
    [Tags]  

*** Keywords ***
Check Server Existence
    [Arguments]  ${servername}  ${boolean}
    ${status}=  Check Server Status  ${servername}
    Should Be Equal  ${status}  ${boolean}

Check Client Existence
    [Arguments]  ${clientname}  ${boolean}
    ${status}=  Check Client Status  ${clientname}
    Should Be Equal  ${status}  ${boolean} 

Create Two TCP Servers And Clients
    Start TCP Server  ${LOOPBACK_DEVICE}  ${DEFAULT_PORT1}  ${SERVER_NAME1}
    Start TCP Server  ${LOOPBACK_DEVICE}  ${DEFAULT_PORT2}  ${SERVER_NAME2}

    Create Tcp Client  ${CLIENT_NAME1}
    Create Tcp Client  ${CLIENT_NAME2}

Delete Two Servers And Clients And Verify Deletion
    Close Server  ${SERVER_NAME1}
    Check Server Existence  ${SERVER_NAME1}  ${False}

    Close Server  ${SERVER_NAME2}
    Check Server Existence  ${SERVER_NAME2}  ${False}

    Close Client  ${CLIENT_NAME1}
    Check Client Existence  ${CLIENT_NAME1}  ${False}

    Close Client  ${CLIENT_NAME2}
    Check Client Existence  ${CLIENT_NAME2}  ${False}
