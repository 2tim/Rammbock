*** Settings ***
Default Tags    regression
Library         rammbock.Rammbock
Resource        resources/data_transfer.txt

*** Variables ***
${EXPECTED_STRING}  ismo_rulettaa
${HOST}  localhost
${PORT}  3011
${PHYSICAL_INTERFACE}  lo
${VIRTUAL_HOST}  1.1.1.1
${RECEIVED_STRING}  ${EMPTY}
${EXPECTED_MODIFIED_STRING}  ismo_rulettaa_koviten

*** Test Cases ***
Send and Receive string over UDP using physical interface
    [Setup]
    GIVEN UDP Server and Client are initialized
    WHEN Client Sends String
    THEN Server Receives String
    [Teardown]  Close Connections

Send data over UDP and modify it and return it back
    [Setup]
    GIVEN UDP Server and Client are initialized
    WHEN Client Sends String
    THEN Server Receives String
    AND Server Modifies String
    AND Server Sends Modified String
    AND Client Receives String Over
    [Teardown]  Close Connections

Try to bind server to network interface which does not exict
    Try to bind server to 'foo' interface
    Exeception "IOError: cannot bind server to interface: 'foo'" should raise

**** Keywords ***

UDP Server and Client are initialized
    Start Server  ${PHYSICAL_INTERFACE}  ${PORT}
    rammbock.Rammbock.connect to server  ${HOST}  ${PORT}

Close Connections
    Close Client
    Close Server

Try to bind server to ${interface} interface
    ${error}=  Run Keyword And Expect Error  *  Start Server  ${interface}  ${PORT}
    Set Test Variable  ${EXCEPTION}  ${error}

Exeception "${except}" should raise
    Should Be Equal  ${EXCEPTION}  ${except}