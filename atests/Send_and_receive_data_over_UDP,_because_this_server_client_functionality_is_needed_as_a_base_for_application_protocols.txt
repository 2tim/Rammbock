*** Settings ***
Default Tags    regression
Library         rammbock.Rammbock

*** Variables ***
${EXPECTED_STRING}  ismo_rulettaa
${HOST}  localhost
${PORT}  3011
${PHYSICAL_INTERFACE}  lo
${VIRTUAL_HOST}  1.1.1.1
${RECEIVED_STRING}  ${EMPTY}
${EXPECTED_MODIFIED_STRING}  ismo_rulettaa_koviten

*** Test Cases ***
Send and Receive string over UDP using physical interface
    [Setup]
    GIVEN UDP Server and Client are initialized
    WHEN Client Sends String
    THEN Server Receives String
    [Teardown]  Close Connections

Send data over UDP and modify it and return it back
    [Setup]
    GIVEN UDP Server and Client are initialized
    WHEN Client Sends String
    THEN Server Receives String
    AND Server Modifies String
    AND Server Sends Modified String
    AND Client Receives String Over
    [Teardown]  Close Connections

Try to bind server to network interface which does not exict
    [tags]  
    Try to bind server to 'foo' interface
    Exeception 'cannot bind server to interface: foo' should raise

**** Keywords ***

Server Receives String
    ${RECEIVED_STRING}=  server receive packet over udp
    Set Test Variable  \${RECEIVED_STRING}  ${RECEIVED_STRING}
    Should Be Equal  ${RECEIVED_STRING}  ${EXPECTED_STRING}

Client Sends String
    client send packet over udp  ${EXPECTED_STRING}

UDP Server and Client are initialized
    Start Server  ${PHYSICAL_INTERFACE}  ${PORT}
    rammbock.Rammbock.connect to server  ${HOST}  ${PORT}

Close Connections
    Close Client
    Close Server

Server Modifies String
    Set Test Variable  \${RECEIVED_STRING}  ${RECEIVED_STRING}_koviten

Server Sends Modified String
    server send packet over udp  ${RECEIVED_STRING}

Client Receives String Over
    ${RECEIVED_STRING}=  client receive packet over udp
    Should Be Equal  ${RECEIVED_STRING}  ${EXPECTED_MODIFIED_STRING}

Try to bind server to ${interface} interface
    Start Server  ${interface}  ${PORT}


Exeception ${exception} should raise
