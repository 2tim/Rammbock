*** Settings ***
Test Setup      UDP Server and Client are initialized
Test Teardown   Close Connections
Default Tags    regression
Library         rammbock.Rammbock
Resource        ../resources/Messaging.txt

*** Test Cases ***
Create gtpv2 message with headers
    [Tags]  ${EMPTY}
    Create Message and add gtpv2 headers
    Client sends message
    Server receives data and validates header

Create gtpv2 message with information elements
    [Tags]

Create gtpv2 session request/response
    [Tags]

Create gtpv2 message with flags
    [Tags]  regression
    Create Message and Add Flags
    Client sends message
    Server receives and validates data

Create gtpv2 message with flags and decode it
    Create Message and Add Flags
    Client sends message
    Server receives and validates message

*** Keywords ***
Create Message and add gtpv2 headers
    Create Message
    Add Binary  Flags  216  1

Server receives data and validates header
    Receive data and validate against string  \ 7

Receive data and validate against string
    [Arguments]  ${content}
    ${data}=  Server Receives Data
    Should Be Equal  ${data}  ${content}

Server receives and validates message
    Create Message
    Add Binary Schema  Flags  1
    Server Receives Message
    ${flags}=  Get Binary Data  Flags
    Should Be Equal  ${flags}  72

Create Message and Add Flags
    Create Message
    Add Binary  Flags  72  1  # 010. .... = Version: 2, ...1 .... = P: 0, .... 1... = T: 1

Server receives and validates data
    ${message}=  Server Receives Data
    Should Be Equal As Strings  ${message}  H

