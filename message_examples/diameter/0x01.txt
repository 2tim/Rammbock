*** Settings ***
Resource        variables.txt
Resource        message_creation.txt
Resource        message_validation.txt
Library         String

*** Keywords ***
Set Capabilities-ExchangeRequest
    Add Message Version  0x01
    Add Message Length  188
    Add Message Flags  0x80
    Add Command Code  ${command_code.capabilities_exchange}
    Add Application Id  0
    Add Hop-By-Hop Identifier  0xe36006e2
    Add End-To-End Identifier  0x00003bab
    Add AVP: Origin-Host  originhost.mme.com
    Add AVP: Origin-Realm  originrealmnsn.com
    Add AVP: Host-IP-Address  192.168.112.20
    Add AVP: Vendor-Id  ${vendor_id.nsn}
    Add AVP: Product-Name  FlexiNS
    Add AVP: Supported-Vendor-Id  10415
    Add AVP: Vendor-Specific-Application-Id  10415  16777251
    Add AVP: Inband-Security-Id  ${NO_INBAND_SECURITY}
    Add AVP: Firmware-Revision  1

Validate Capabilities-ExchangeRequest
    Validate Message Version  0x01
    Validate Message Length  188
    Validate Message Flags  0x80
    Validate Command Code  ${command_code.capabilities_exchange}
    Validate Application Id  0
    Validate Hop-By-Hop Identifier  0xe36006e2
    Validate End-To-End Identifier  0x00003bab
    Validate AVP: Origin-Host  originhost.mme.com
    Validate AVP: Origin-Realm  originrealmnsn.com
    Validate AVP: Host-IP-Address  192.168.112.20
    Validate AVP: Vendor-Id  ${vendor_id.nsn}
    Validate AVP: Product-Name  FlexiNS
    Validate AVP: Supported-Vendor-Id  10415
    Validate AVP: Vendor-Specific-Application-Id  10415  16777251
    Validate AVP: Inband-Security-Id  ${NO_INBAND_SECURITY}
    Validate AVP: Firmware-Revision  1

Set Capabilities-ExchangeAnswer
    Add Message Version  0x01
    Add Message Length  132
    Add Message Flags  0x00
    Add Command Code  ${command_code.capabilities_exchange}
    Add ApplicationId  0
    Add Hop-by-Hop Identifier  0xe36006e2
    Add End-to-End Identifier  0x00003bab
    Add AVP: Result-Code  ${DIAMETER_SUCCESS}
    Add AVP: Origin-Host  HSS.ttcn3
    Add AVP: Origin-Realm  test.nsn.com
    Add AVP: Host-Ip-Address  10.102.250.95
    Add AVP: Vendor-Id  10415
    Add AVP: Product-Name  Authentication Server
    Add Decimal As Octets  0  3  # spare / delimiter?

Validate Capabilities-ExchangeAnswer
    Validate Message Version  0x01
    Validate Message Length  132
    Validate Message Flags  0x00
    Validate Command Code  ${command_code.capabilities_exchange}
    Validate ApplicationId  0
    Validate Hop-by-Hop Identifier  0xe36006e2
    Validate End-to-End Identifier  0x00003bab
    Validate AVP: Result-Code  ${DIAMETER_SUCCESS}
    Validate AVP: Origin-Host  HSS.ttcn3
    Validate AVP: Origin-Realm  test.nsn.com
    Validate AVP: Host-Ip-Address  10.102.250.95
    Validate AVP: Vendor-Id  10415
    Validate AVP: Product-Name  Authentication Server
    Read From Data  3  # spare / delimiter?

Set 3GPP-Authentication-InformationRequest

Validate 3GPP-Authentication-InformationRequest

Set 3GPP-Authentication-InformationAnswer

Validate 3GPP-Authentication-InformationAnswer

Set 3GPP-Update-LocationRequest

Validate 3GPP-Update-LocationRequest

Set 3GPP-Update-LocationAnswer

Validate 3GPP-Update-LocationAnswer

Set Disconnect-PeerRequest

Validate Disconnect-PeerRequest

Set Disconnect-PeerAnswer

Validate Disconnect-PeerAnswer

