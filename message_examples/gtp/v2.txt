*** Settings ***
Resource        message_creation.txt
Resource        message_validation.txt
Resource        variables.txt

*** Variables ***
${MCC}  262
${MNC}  12

*** Keywords ***
Set Create Session Request
    Add Flags  72  # Version:2 P: 0 T: 1
    Add Message Type  32  # Create Session Request
    Add Message Length  216
    Add Tunnel Endpoint Identifier  0
    Add Sequence Number  48
    Add Spare Octets  1
    Add International Mobile Subscriber Identity (IMSI)  262120000000001
    Add MSISDN  358  6100000000001
    Add User Location Info (ULI)  ${MCC}  ${MNC}
    Add Serving Network  ${MCC}  ${MNC}
    Add RAT Type
    Add Indication
    Add Fully Qualified Tunnel Endpoint Identifier (F-TEID)  50331665  192.168.112.10  138  # ...0 1010 = Interface Type: S11 MME GTP-C interface (10)
    Add Fully Qualified Tunnel Endpoint Identifier (F-TEID)  0  10.102.182.184  135  # ...0 0111 = Interface Type: S5/S8 PGW GTP-C interface (7)
    Add Access Point Name (APN)  sgw.nsn.com.mnc012.mcc262.gprs
    Add Selection Mode
    Add PDN Type
    Add PDN Address Allocation (PAA)  0.0.0.0  # PDN IPv4: 0.0.0.0 (0.0.0.0)
    Add APN Restriction
    Add Aggregate Maximum Bit Rate (AMBR)
    Add Bearer Context : [Grouped IE]
    Add Recovery (Restart Counter)  1
    Add UE Time Zone
    Add Charging Characteristics

Validate Create Session Request
    Validate Flags  72  # Version:2 P: 0 T: 1
    Validate Message Type  32  # Create Session Request
    Validate Message Length  216
    Validate Tunnel Endpoint Identifier  0
    Validate Sequence Number  48
    Read From Data  1  # Read spare octets
    Validate International Mobile Subscriber Identity (IMSI)  262120000000001
    Validate MSISDN  358  6100000000001
    Validate User Location Info (ULI)  ${MCC}  ${MNC}
    Validate Serving Network  ${MCC}  ${MNC}
    Validate RAT Type
    Validate Indication
    Validate Fully Qualified Tunnel Endpoint Identifier (F-TEID)  50331665  192.168.112.10  138
    Validate Fully Qualified Tunnel Endpoint Identifier (F-TEID)  0  10.102.182.184  135
    Validate Access Point Name (APN)
    Validate Selection Mode
    Validate PDN Type
    Validate PDN Address Allocation (PAA)
    Validate APN Restriction
    Validate Aggregate Maximum Bit Rate (AMBR)
    Validate Bearer Context : [Grouped IE]
    Validate Recovery (Restart Counter)
    Validate UE Time Zone
    Validate Charging Characteristics

Set Create Session Response
    Add Flags  72
    Add Message Type  33  # create session response
    Add Message Length  136
    Add Tunnel Endpoint Identifier  50331665
    Add Sequence Number  48
    Add Spare Octets  1
    Add Cause
    Add Fully Qualified Tunnel Endpoint Identifier (F-TEID)  123564  10.102.250.95  139  # ...0 1011 = Interface Type: S11/S4 SGW GTP-C interface (11)
    Add PDN Address Allocation (PAA)  192.168.0.1  # Prefix(IPv4): 192.168.0.1 (192.168.0.1)
    Add APN Restriction
    Add Bearer Context with EBI, Cause, F-TEID and CI : [Grouped IE]
    Add Recovery (Restart Counter)  13
    Add Fully Qualified Domain Name (FQDN)  rammbock.googlecode.com
    Add Ip Address  17.34.51.68

Validate Create Session Response

