*** Settings ***
Library         Rammbock
Resource        variables.txt

*** Variables ***
${PDUvalue.length}  61

*** Keywords ***
Add procedureCode
    [Arguments]  ${pc}
    Add Decimal As Octets  ${pc}  1

Add Criticality
    [Arguments]  ${criticality}
    Add Hex Data  ${criticality}  1

Add value: S1SetupRequest
    Start S1SetupRequest
    Add id-Global-ENB-ID
    Add id-eNBname
    Add id-SupportedTAs
    Add id-DefaultPagingDRX

Start S1SetupRequest
    Add Decimal As Octets  ${PDUvalue.length}  1
    Add Hex Data  000004  3  #TODO: check what is the meaning of these bytes.

Add id-Global-ENB-ID
    Add id  ${id-Global-ENB-ID}
    Add Criticality  0
    Add Global-ENB-ID value  ${MCC.Germany}  ${MNC.Dolphin Telecom}  00aad610

Add id
    [Arguments]  ${id}
    Add Decimal As Octets  ${id}  2

Add Global-ENB-ID value
    [Arguments]  ${Mobile Country Code}  ${Mobile Network Code}  ${macroENB-ID}
    Add Hex Data  0800  2
    Add PLMNidentitity  ${Mobile Country Code}  ${Mobile Network Code}
    Add Hex Data  ${macroENB-ID}  4  # TODO: this has internal syntax, basicly a padded bit string. Make this smarter

Add id-eNBname
    Add id  ${id-eNBname}
    Add Criticality  ${criticality.ignore}
    Add id-EBname value  ${EBname}

Add id-EBname value
    [Arguments]  ${ENBname}
    Add Hex Data  08  1  # TODO: what is the meaning of this?
    Add Hex Data  ${eNBnam.extension presen bit: False}  1
    Add Hex Data  80  1  # TODO: what is the meaning of this? length most likely
    Add String  ${ENBname}

Add id-SupportedTAs
    Add id  ${id-SupportedTAs}
    Add Criticality  0
    Add Hex Data  19  1  # TODO: hard coded length.
    Add hex DAta  03  1  # TODO: another hardcoded value... (number of elements in a sequence?)
    Add TA item  000040  ${MCC.Germany}  ${MNC.Dolphin Telecom}
    Add TA item  000080  ${MCC.Germany}  ${MNC.Dolphin Telecom}
    Add TA item  0000c0  ${MCC.Germany}  ${MNC.Dolphin Telecom}
    Add TA item  009500  ${MCC.Germany}  ${MNC.Dolphin Telecom}

Add PLMNidentitity
    [Arguments]  ${Mobile Country Code}  ${Mobile Network Code}
    Add Number As Tbcd  ${Mobile Country Code}
    Add Number As Tbcd  ${Mobile Network Code}

Add TA item
    [Arguments]  ${tAC}  ${Mobile Country Code}  ${Mobile Network Code}
    [Documentation]  TODO: tAC should be smarter (now its given as a hex string, should be given as actual value)
    Add Hex Data  ${tAC}  3
    Add PLMNidentitity  ${Mobile Country Code}  ${Mobile Network Code}

Add id-DefaultPagingDRX
    Add id  ${id-DefaultPagingDRX}
    Add Criticality  ${criticality.ignore}
    Add PagingDRX: v32

Add PagingDRX: v32
    [Documentation]  TODO: Make this smarter
    Add Hex Data  0100  2

Start new PDU
    [Arguments]  ${pdu type}
    Add Hex Data  ${pdu type}  1

