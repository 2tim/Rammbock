*** Settings ***
Test Setup        Setup protocol, server, and client
Library           Rammbock.py
Resource          Protocols.txt


*** Variables ***
${SERVER}         127.0.0.1
${SERVER PORT}    54321

*** Test Cases ***
Server uses protocol and receives a dynamic message
    Client Sends hex    0x 01 00 aaaa 0e 0000 03 cafebabe d00d
    ${msg} =    Server Receives dynamic request
    Should be equal    ${msg.pair.first.hex}    0xca
    Should be equal    ${msg.pair[0].first.hex}    0xca
    Should be equal    ${msg.pair[0].second.hex}    0xfe
    Should be equal    ${msg.pair[2].first.hex}    0xd0

*** Keywords ***
Server Receives dynamic request
    [Arguments]    @{params}
    New Message    Example    messageType=0xaaaa
    u8    numberOfPairs
    Struct    numberOfPairs    pair
    u8    first
    u8    second
    End struct    pair
    ${msg} =    Server Receives message    @{params}