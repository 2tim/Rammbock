*** Settings ***
Resource          Protocols.txt
Test Setup        Setup protocol, UDP server, and client
Test teardown     Teardown rammbock and increment port numbers

*** Test cases ***
Client sends message with field value from template
    Client sends     ExampleMessage
    ${msg}=     Server receives     ExampleMessage
    Should be equal as integers  1    ${msg.foo}
    Should be equal as integers  2    ${msg.bar} 

Client sends message with field value from value definition
    Client sends     Value ExampleMessage
    ${msg}=     Server receives     Value ExampleMessage
    Should be equal as integers  10    ${msg.foo}
    Should be equal as integers  2    ${msg.bar} 

Client sends message with field value from parameters
    Client sends     Value ExampleMessage   bar:15
    ${msg}=     Server receives     Value ExampleMessage    bar:15
    Should be equal as integers  10    ${msg.foo}
    Should be equal as integers  15    ${msg.bar} 

Receive message with field value from template
    Fail   not implemented

Receive message with field value from value definition
    Fail   not implemented

Receive message with field value from parameters
    Fail   not implemented
    
*** Keywords ***
ExampleMessage
    New Message     ExampleMessage    Example    messageType:0xbabe  
    u16             foo       1
    u8              bar       2
    u8              faa       
    
Value ExampleMessage
    ExampleMessage
    Value           foo      10
    
Client sends
    [Arguments]    ${message type}   @{params}
    Run keyword    ${message type}
    Client sends message    @{params}
    
Server receives
    [Arguments]    ${message type}   @{params}
    Run keyword    ${message type}
    ${msg}=     Server receives message    @{params}  
    [Return]     ${msg}
    
    
    
